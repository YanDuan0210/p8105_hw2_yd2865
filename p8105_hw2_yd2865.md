p8105_hw2_yd2865
================
Yan Duan
2025-09-16

I’m an R Markdown document!

## Problem 1

#### Clean the data in pols-month.csv

``` r
pols_df = 
  read_csv("./fivethirtyeight_datasets/pols-month.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day"), sep = "-" ) |> 
  mutate(
    year = as.integer(year),
    month = factor(month.name[as.integer(month)],
         levels = month.name),
         president = 
           case_when(
             prez_gop == 1 ~ "gop",
             prez_dem == 1 ~ "dem")) |> 
  select(year, month, president, everything(), -day, -prez_gop, -prez_dem) |> 
  arrange(year, month)
pols_df
```

    ## # A tibble: 822 × 9
    ##     year month     president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##    <int> <fct>     <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1  1947 January   dem            23      51     253      23      45     198
    ##  2  1947 February  dem            23      51     253      23      45     198
    ##  3  1947 March     dem            23      51     253      23      45     198
    ##  4  1947 April     dem            23      51     253      23      45     198
    ##  5  1947 May       dem            23      51     253      23      45     198
    ##  6  1947 June      dem            23      51     253      23      45     198
    ##  7  1947 July      dem            23      51     253      23      45     198
    ##  8  1947 August    dem            23      51     253      23      45     198
    ##  9  1947 September dem            23      51     253      23      45     198
    ## 10  1947 October   dem            23      51     253      23      45     198
    ## # ℹ 812 more rows

#### Clean the data in snp.csv

``` r
snp_df = 
  read_csv("./fivethirtyeight_datasets/snp.csv", na = c("NA", ".", "")) |> 
  janitor::clean_names() |>
  separate(date, into = c("year", "month", "day"), sep = "/") |> 
  mutate(
   year = as.integer(year),
   year  = if_else(year <= 25, 2000L + year, 1900L + year),
   month = factor(month.name[as.integer(month)],
         levels = month.name)) |> 
  select(year, month, close) |> 
  arrange(year, month)
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month    close
    ##    <int> <fct>    <dbl>
    ##  1  2001 February 1995.
    ##  2  2001 February 1783.
    ##  3  2001 February 1498.
    ##  4  2001 February  826.
    ##  5  2001 February 1379.
    ##  6  2001 February 1131.
    ##  7  2001 February  856.
    ##  8  2001 February 1130.
    ##  9  2001 February 1366.
    ## 10  2001 February  980.
    ## # ℹ 777 more rows

#### Tidy the unemployment data

``` r
unemp_df =
  read_csv("./fivethirtyeight_datasets/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemp_rate") |>
   mutate(
    year = as.integer(year),
    month = match(str_to_title(month), month.abb),
    month = factor(month.name[as.integer(month)],
         levels = month.name)) |> 
  arrange(year, month)
unemp_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemp_rate
    ##    <int> <fct>          <dbl>
    ##  1  1948 January          3.4
    ##  2  1948 February         3.8
    ##  3  1948 March            4  
    ##  4  1948 April            3.9
    ##  5  1948 May              3.5
    ##  6  1948 June             3.6
    ##  7  1948 July             3.6
    ##  8  1948 August           3.9
    ##  9  1948 September        3.8
    ## 10  1948 October          3.7
    ## # ℹ 806 more rows

#### Joining datasets

``` r
# Join the datasets by merging `snp` into `pols`

pols_snp =
  left_join(pols_df, snp_df, by = c("year", "month")) 

# Merging `unemployment` into the result
merged_df = 
  left_join(pols_snp, unemp_df, by = c("year", "month")) 
merged_df
```

    ## # A tibble: 1,571 × 11
    ##     year month   president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem close
    ##    <int> <fct>   <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>
    ##  1  1947 January dem            23      51     253      23      45     198    NA
    ##  2  1947 Februa… dem            23      51     253      23      45     198    NA
    ##  3  1947 March   dem            23      51     253      23      45     198    NA
    ##  4  1947 April   dem            23      51     253      23      45     198    NA
    ##  5  1947 May     dem            23      51     253      23      45     198    NA
    ##  6  1947 June    dem            23      51     253      23      45     198    NA
    ##  7  1947 July    dem            23      51     253      23      45     198    NA
    ##  8  1947 August  dem            23      51     253      23      45     198    NA
    ##  9  1947 Septem… dem            23      51     253      23      45     198    NA
    ## 10  1947 October dem            23      51     253      23      45     198    NA
    ## # ℹ 1,561 more rows
    ## # ℹ 1 more variable: unemp_rate <dbl>

This analysis utilized three datasets: `pols-month.csv`, `snp.csv` and
`unemployment.csv`.

- The `pols_df` dataset, after being organized, contains monthly data on
  the political structure of the United States starting from 1947,
  including `year`, `month`, `president` (the political party of the
  president, `gop` or `dem`), and the distribution numbers of state
  governors, senators, and representatives between the two parties (such
  as `gov_gop`, `sen_gop`, `rep_dem`).
- The `snp_df` provides the monthly closing prices of the S&P 500 index
  during the same period (use variable `close`), with `year` and `month`
  serving as the keys.
- The variable `unemp_df` represents the monthly unemployment rate in
  the United States. Originally, it was stored in columns for 12 months.
  After being organized, it was transformed into “long format” and the
  same keys of `year` and `month` were used.

During the cleaning process, the date variables in all three datasets
were unified into `year` and `month`, and the months were standardized
to the full English names of the months to ensure a smooth merge.
Eventually, we used the `left_join()` function to first merge the
`snp_df` into the `pols_df`, and then merge the `unemp_df`, resulting in
the `merged_df` data frame which contains approximately 1,571 monthly
observation records. The time span ranges from January 1947 to around
June 2015.

The final table integrates the political structure, the closing prices
of the stock market, and the unemployment rate, providing a complete
time series of data for analyzing the relationship between the political
and economic fluctuations in the United States.
